<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Javaåœºæ™¯100é¢˜ | SwimmingLiu&#39;s Blog</title>
<meta name="keywords" content="Java">
<meta name="description" content="å¹¶å‘ä¸æ€§èƒ½ä¼˜åŒ–
1. å¤§æ–‡ä»¶ä¸Šä¼ å¦‚ä½•å¤„ç†ï¼Ÿåˆ†ç‰‡ä¸Šä¼ 
ç›¸å…³ä»£ç ï¼šhttps://github.com/SwimmingLiu/JavaSceneQuiz100/tree/main/lesson001
1.1 ä¸ºä»€ä¹ˆéœ€è¦åˆ†ç‰‡ä¸Šä¼ ?
å¤§æ–‡ä»¶åœ¨ä¸Šä¼ çš„è¿‡ç¨‹ä¸­ï¼Œè€—è´¹çš„æ—¶é—´æ¯”è¾ƒé•¿ã€‚å¦‚æœç½‘ç»œä¸ç¨³å®šï¼Œå¾ˆå¯èƒ½å¯¼è‡´ä¸Šä¼ å¤±è´¥ï¼Œéœ€è¦é‡æ–°ä¸Šä¼ ã€‚åˆ†ç‰‡ä¸Šä¼ ï¼Œå°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
åˆ†ç‰‡ä¸Šä¼ å®šä¹‰ï¼šå°†å¤§æ–‡ä»¶æ‹†åˆ†ä¸ºä¸åŒçš„æ–‡ä»¶å—ï¼Œé€å—è¿›è¡Œä¸Šä¼ 
1.2 å¦‚ä½•å®ç°åˆ†ç‰‡ä¸Šä¼ ï¼Ÿ
1.2.1 å¦‚ä½•å­˜å‚¨åˆ†ç‰‡ä¿¡æ¯
åˆ†ç‰‡ä¸Šä¼ éœ€è¦è®°å½•æ–‡ä»¶çš„å±æ€§ (md5ã€å¤§å°ã€åç§°)ã€åˆ†ç‰‡æ•°é‡ã€æ–‡ä»¶å­˜å‚¨çš„å®Œæ•´è·¯å¾„ (æœ¬åœ°è·¯å¾„)ï¼Œè¿˜éœ€è¦è®°å½•æ¯ä¸ªåˆ†å—çš„ä¸Šä¼ æƒ…å†µ (åˆ†å—å¤§å°ã€åˆ†å—é¡ºåºã€åˆ†å—ä»»åŠ¡id)ã€‚å¯ä»¥ç”¨ åˆ†å—ä¸Šä¼ ä»»åŠ¡è¡¨ å’Œ åˆ†å—æ–‡ä»¶è¡¨ æ¥è®°å½•ã€‚


åˆ†å—ä»»åŠ¡è¡¨ (t_shard_upload)
create table if not exists t_shard_upload(
    id varchar(32) primary key,
    file_name varchar(256) not null comment &#39;æ–‡ä»¶åç§°&#39;,
    part_num int not null comment &#39;åˆ†ç‰‡æ•°é‡&#39;,
    md5 varchar(128) comment &#39;æ–‡ä»¶md5å€¼&#39;,
    file_full_path varchar(512) comment &#39;æ–‡ä»¶å®Œæ•´è·¯å¾„&#39;
) comment = &#39;åˆ†ç‰‡ä¸Šä¼ ä»»åŠ¡è¡¨&#39;;


åˆ†å—æ–‡ä»¶è¡¨ (t_shard_upload_partï¼‰
create table if not exists  t_shard_upload_part(
    id varchar(32) primary key,
    shard_upload_id varchar(32) not null comment &#39;åˆ†ç‰‡ä»»åŠ¡idï¼ˆt_shard_upload.idï¼‰&#39;,
    part_order int not null comment &#39;ç¬¬å‡ ä¸ªåˆ†ç‰‡ï¼Œä»1å¼€å§‹&#39;,
    file_full_path varchar(512) comment &#39;æ–‡ä»¶å®Œæ•´è·¯å¾„&#39;,
    UNIQUE KEY `uq_part_order` (`shard_upload_id`,`part_order`)
) comment = &#39;åˆ†ç‰‡æ–‡ä»¶è¡¨ï¼Œæ¯ä¸ªåˆ†ç‰‡æ–‡ä»¶å¯¹åº”ä¸€æ¡è®°å½•&#39;;


åˆ†å—æ–‡ä»¶è¡¨å’Œåˆ†å—ä¸Šä¼ è¡¨æ˜¯ 1 to M çš„å…³ç³»ï¼Œå‡å¦‚å½“å‰æ–‡ä»¶åˆ†ä¸º10å—ã€‚åˆ™ä¼šå‡ºç°1ä¸ªåˆ†ç‰‡ä¸Šä¼ ä»»åŠ¡ï¼Œå’Œ10ä¸ªåˆ†ç‰‡æ–‡ä»¶è®°å½•ã€‚">
<meta name="author" content="SwimmingLiu">
<link rel="canonical" href="https://swimmingliu.cn/posts/job/java-scene-quiz-100/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.c7b99e18e355220f53ae289ce2a6dc0b03635feaa71ac4051b0715fcc8ffcab9.css" integrity="sha256-x7meGONVIg9Triic4qbcCwNjX&#43;qnGsQFGwcV/Mj/yrk=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<link rel="apple-touch-icon" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<link rel="mask-icon" href="https://swimmingliu.cn/images/swimmingliu_icon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://swimmingliu.cn/posts/job/java-scene-quiz-100/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
            
            
            delimiters: [
                { left: '$$', right: '$$', display: true },
                { left: '$', right: '$', display: false },
                { left: '\\(', right: '\\)', display: false },
                { left: '\\[', right: '\\]', display: true }
            ],
            
            throwOnError: false
        });
    });
</script>

<meta property="og:url" content="https://swimmingliu.cn/posts/job/java-scene-quiz-100/">
  <meta property="og:site_name" content="SwimmingLiu&#39;s Blog">
  <meta property="og:title" content="Javaåœºæ™¯100é¢˜">
  <meta property="og:description" content="å¹¶å‘ä¸æ€§èƒ½ä¼˜åŒ– 1. å¤§æ–‡ä»¶ä¸Šä¼ å¦‚ä½•å¤„ç†ï¼Ÿåˆ†ç‰‡ä¸Šä¼  ç›¸å…³ä»£ç ï¼šhttps://github.com/SwimmingLiu/JavaSceneQuiz100/tree/main/lesson001
1.1 ä¸ºä»€ä¹ˆéœ€è¦åˆ†ç‰‡ä¸Šä¼ ? å¤§æ–‡ä»¶åœ¨ä¸Šä¼ çš„è¿‡ç¨‹ä¸­ï¼Œè€—è´¹çš„æ—¶é—´æ¯”è¾ƒé•¿ã€‚å¦‚æœç½‘ç»œä¸ç¨³å®šï¼Œå¾ˆå¯èƒ½å¯¼è‡´ä¸Šä¼ å¤±è´¥ï¼Œéœ€è¦é‡æ–°ä¸Šä¼ ã€‚åˆ†ç‰‡ä¸Šä¼ ï¼Œå°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
åˆ†ç‰‡ä¸Šä¼ å®šä¹‰ï¼šå°†å¤§æ–‡ä»¶æ‹†åˆ†ä¸ºä¸åŒçš„æ–‡ä»¶å—ï¼Œé€å—è¿›è¡Œä¸Šä¼ 
1.2 å¦‚ä½•å®ç°åˆ†ç‰‡ä¸Šä¼ ï¼Ÿ 1.2.1 å¦‚ä½•å­˜å‚¨åˆ†ç‰‡ä¿¡æ¯ åˆ†ç‰‡ä¸Šä¼ éœ€è¦è®°å½•æ–‡ä»¶çš„å±æ€§ (md5ã€å¤§å°ã€åç§°)ã€åˆ†ç‰‡æ•°é‡ã€æ–‡ä»¶å­˜å‚¨çš„å®Œæ•´è·¯å¾„ (æœ¬åœ°è·¯å¾„)ï¼Œè¿˜éœ€è¦è®°å½•æ¯ä¸ªåˆ†å—çš„ä¸Šä¼ æƒ…å†µ (åˆ†å—å¤§å°ã€åˆ†å—é¡ºåºã€åˆ†å—ä»»åŠ¡id)ã€‚å¯ä»¥ç”¨ åˆ†å—ä¸Šä¼ ä»»åŠ¡è¡¨ å’Œ åˆ†å—æ–‡ä»¶è¡¨ æ¥è®°å½•ã€‚
åˆ†å—ä»»åŠ¡è¡¨ (t_shard_upload)
create table if not exists t_shard_upload( id varchar(32) primary key, file_name varchar(256) not null comment &#39;æ–‡ä»¶åç§°&#39;, part_num int not null comment &#39;åˆ†ç‰‡æ•°é‡&#39;, md5 varchar(128) comment &#39;æ–‡ä»¶md5å€¼&#39;, file_full_path varchar(512) comment &#39;æ–‡ä»¶å®Œæ•´è·¯å¾„&#39; ) comment = &#39;åˆ†ç‰‡ä¸Šä¼ ä»»åŠ¡è¡¨&#39;; åˆ†å—æ–‡ä»¶è¡¨ (t_shard_upload_partï¼‰
create table if not exists t_shard_upload_part( id varchar(32) primary key, shard_upload_id varchar(32) not null comment &#39;åˆ†ç‰‡ä»»åŠ¡idï¼ˆt_shard_upload.idï¼‰&#39;, part_order int not null comment &#39;ç¬¬å‡ ä¸ªåˆ†ç‰‡ï¼Œä»1å¼€å§‹&#39;, file_full_path varchar(512) comment &#39;æ–‡ä»¶å®Œæ•´è·¯å¾„&#39;, UNIQUE KEY `uq_part_order` (`shard_upload_id`,`part_order`) ) comment = &#39;åˆ†ç‰‡æ–‡ä»¶è¡¨ï¼Œæ¯ä¸ªåˆ†ç‰‡æ–‡ä»¶å¯¹åº”ä¸€æ¡è®°å½•&#39;; åˆ†å—æ–‡ä»¶è¡¨å’Œåˆ†å—ä¸Šä¼ è¡¨æ˜¯ 1 to M çš„å…³ç³»ï¼Œå‡å¦‚å½“å‰æ–‡ä»¶åˆ†ä¸º10å—ã€‚åˆ™ä¼šå‡ºç°1ä¸ªåˆ†ç‰‡ä¸Šä¼ ä»»åŠ¡ï¼Œå’Œ10ä¸ªåˆ†ç‰‡æ–‡ä»¶è®°å½•ã€‚">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-07-06T13:27:35+08:00">
    <meta property="article:modified_time" content="2025-07-06T13:27:35+08:00">
    <meta property="article:tag" content="Java">
      <meta property="og:image" content="https://swimmingliu.cn/papermod-cover.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://swimmingliu.cn/papermod-cover.png">
<meta name="twitter:title" content="Javaåœºæ™¯100é¢˜">
<meta name="twitter:description" content="å¹¶å‘ä¸æ€§èƒ½ä¼˜åŒ–
1. å¤§æ–‡ä»¶ä¸Šä¼ å¦‚ä½•å¤„ç†ï¼Ÿåˆ†ç‰‡ä¸Šä¼ 
ç›¸å…³ä»£ç ï¼šhttps://github.com/SwimmingLiu/JavaSceneQuiz100/tree/main/lesson001
1.1 ä¸ºä»€ä¹ˆéœ€è¦åˆ†ç‰‡ä¸Šä¼ ?
å¤§æ–‡ä»¶åœ¨ä¸Šä¼ çš„è¿‡ç¨‹ä¸­ï¼Œè€—è´¹çš„æ—¶é—´æ¯”è¾ƒé•¿ã€‚å¦‚æœç½‘ç»œä¸ç¨³å®šï¼Œå¾ˆå¯èƒ½å¯¼è‡´ä¸Šä¼ å¤±è´¥ï¼Œéœ€è¦é‡æ–°ä¸Šä¼ ã€‚åˆ†ç‰‡ä¸Šä¼ ï¼Œå°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
åˆ†ç‰‡ä¸Šä¼ å®šä¹‰ï¼šå°†å¤§æ–‡ä»¶æ‹†åˆ†ä¸ºä¸åŒçš„æ–‡ä»¶å—ï¼Œé€å—è¿›è¡Œä¸Šä¼ 
1.2 å¦‚ä½•å®ç°åˆ†ç‰‡ä¸Šä¼ ï¼Ÿ
1.2.1 å¦‚ä½•å­˜å‚¨åˆ†ç‰‡ä¿¡æ¯
åˆ†ç‰‡ä¸Šä¼ éœ€è¦è®°å½•æ–‡ä»¶çš„å±æ€§ (md5ã€å¤§å°ã€åç§°)ã€åˆ†ç‰‡æ•°é‡ã€æ–‡ä»¶å­˜å‚¨çš„å®Œæ•´è·¯å¾„ (æœ¬åœ°è·¯å¾„)ï¼Œè¿˜éœ€è¦è®°å½•æ¯ä¸ªåˆ†å—çš„ä¸Šä¼ æƒ…å†µ (åˆ†å—å¤§å°ã€åˆ†å—é¡ºåºã€åˆ†å—ä»»åŠ¡id)ã€‚å¯ä»¥ç”¨ åˆ†å—ä¸Šä¼ ä»»åŠ¡è¡¨ å’Œ åˆ†å—æ–‡ä»¶è¡¨ æ¥è®°å½•ã€‚


åˆ†å—ä»»åŠ¡è¡¨ (t_shard_upload)
create table if not exists t_shard_upload(
    id varchar(32) primary key,
    file_name varchar(256) not null comment &#39;æ–‡ä»¶åç§°&#39;,
    part_num int not null comment &#39;åˆ†ç‰‡æ•°é‡&#39;,
    md5 varchar(128) comment &#39;æ–‡ä»¶md5å€¼&#39;,
    file_full_path varchar(512) comment &#39;æ–‡ä»¶å®Œæ•´è·¯å¾„&#39;
) comment = &#39;åˆ†ç‰‡ä¸Šä¼ ä»»åŠ¡è¡¨&#39;;


åˆ†å—æ–‡ä»¶è¡¨ (t_shard_upload_partï¼‰
create table if not exists  t_shard_upload_part(
    id varchar(32) primary key,
    shard_upload_id varchar(32) not null comment &#39;åˆ†ç‰‡ä»»åŠ¡idï¼ˆt_shard_upload.idï¼‰&#39;,
    part_order int not null comment &#39;ç¬¬å‡ ä¸ªåˆ†ç‰‡ï¼Œä»1å¼€å§‹&#39;,
    file_full_path varchar(512) comment &#39;æ–‡ä»¶å®Œæ•´è·¯å¾„&#39;,
    UNIQUE KEY `uq_part_order` (`shard_upload_id`,`part_order`)
) comment = &#39;åˆ†ç‰‡æ–‡ä»¶è¡¨ï¼Œæ¯ä¸ªåˆ†ç‰‡æ–‡ä»¶å¯¹åº”ä¸€æ¡è®°å½•&#39;;


åˆ†å—æ–‡ä»¶è¡¨å’Œåˆ†å—ä¸Šä¼ è¡¨æ˜¯ 1 to M çš„å…³ç³»ï¼Œå‡å¦‚å½“å‰æ–‡ä»¶åˆ†ä¸º10å—ã€‚åˆ™ä¼šå‡ºç°1ä¸ªåˆ†ç‰‡ä¸Šä¼ ä»»åŠ¡ï¼Œå’Œ10ä¸ªåˆ†ç‰‡æ–‡ä»¶è®°å½•ã€‚">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "ğŸ“š Posts",
      "item": "https://swimmingliu.cn/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸ’» Job",
      "item": "https://swimmingliu.cn/posts/job/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Javaåœºæ™¯100é¢˜",
      "item": "https://swimmingliu.cn/posts/job/java-scene-quiz-100/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Javaåœºæ™¯100é¢˜",
  "name": "Javaåœºæ™¯100é¢˜",
  "description": "å¹¶å‘ä¸æ€§èƒ½ä¼˜åŒ– 1. å¤§æ–‡ä»¶ä¸Šä¼ å¦‚ä½•å¤„ç†ï¼Ÿåˆ†ç‰‡ä¸Šä¼  ç›¸å…³ä»£ç ï¼šhttps://github.com/SwimmingLiu/JavaSceneQuiz100/tree/main/lesson001\n1.1 ä¸ºä»€ä¹ˆéœ€è¦åˆ†ç‰‡ä¸Šä¼ ? å¤§æ–‡ä»¶åœ¨ä¸Šä¼ çš„è¿‡ç¨‹ä¸­ï¼Œè€—è´¹çš„æ—¶é—´æ¯”è¾ƒé•¿ã€‚å¦‚æœç½‘ç»œä¸ç¨³å®šï¼Œå¾ˆå¯èƒ½å¯¼è‡´ä¸Šä¼ å¤±è´¥ï¼Œéœ€è¦é‡æ–°ä¸Šä¼ ã€‚åˆ†ç‰‡ä¸Šä¼ ï¼Œå°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\nåˆ†ç‰‡ä¸Šä¼ å®šä¹‰ï¼šå°†å¤§æ–‡ä»¶æ‹†åˆ†ä¸ºä¸åŒçš„æ–‡ä»¶å—ï¼Œé€å—è¿›è¡Œä¸Šä¼ \n1.2 å¦‚ä½•å®ç°åˆ†ç‰‡ä¸Šä¼ ï¼Ÿ 1.2.1 å¦‚ä½•å­˜å‚¨åˆ†ç‰‡ä¿¡æ¯ åˆ†ç‰‡ä¸Šä¼ éœ€è¦è®°å½•æ–‡ä»¶çš„å±æ€§ (md5ã€å¤§å°ã€åç§°)ã€åˆ†ç‰‡æ•°é‡ã€æ–‡ä»¶å­˜å‚¨çš„å®Œæ•´è·¯å¾„ (æœ¬åœ°è·¯å¾„)ï¼Œè¿˜éœ€è¦è®°å½•æ¯ä¸ªåˆ†å—çš„ä¸Šä¼ æƒ…å†µ (åˆ†å—å¤§å°ã€åˆ†å—é¡ºåºã€åˆ†å—ä»»åŠ¡id)ã€‚å¯ä»¥ç”¨ åˆ†å—ä¸Šä¼ ä»»åŠ¡è¡¨ å’Œ åˆ†å—æ–‡ä»¶è¡¨ æ¥è®°å½•ã€‚\nåˆ†å—ä»»åŠ¡è¡¨ (t_shard_upload)\ncreate table if not exists t_shard_upload( id varchar(32) primary key, file_name varchar(256) not null comment \u0026#39;æ–‡ä»¶åç§°\u0026#39;, part_num int not null comment \u0026#39;åˆ†ç‰‡æ•°é‡\u0026#39;, md5 varchar(128) comment \u0026#39;æ–‡ä»¶md5å€¼\u0026#39;, file_full_path varchar(512) comment \u0026#39;æ–‡ä»¶å®Œæ•´è·¯å¾„\u0026#39; ) comment = \u0026#39;åˆ†ç‰‡ä¸Šä¼ ä»»åŠ¡è¡¨\u0026#39;; åˆ†å—æ–‡ä»¶è¡¨ (t_shard_upload_partï¼‰\ncreate table if not exists t_shard_upload_part( id varchar(32) primary key, shard_upload_id varchar(32) not null comment \u0026#39;åˆ†ç‰‡ä»»åŠ¡idï¼ˆt_shard_upload.idï¼‰\u0026#39;, part_order int not null comment \u0026#39;ç¬¬å‡ ä¸ªåˆ†ç‰‡ï¼Œä»1å¼€å§‹\u0026#39;, file_full_path varchar(512) comment \u0026#39;æ–‡ä»¶å®Œæ•´è·¯å¾„\u0026#39;, UNIQUE KEY `uq_part_order` (`shard_upload_id`,`part_order`) ) comment = \u0026#39;åˆ†ç‰‡æ–‡ä»¶è¡¨ï¼Œæ¯ä¸ªåˆ†ç‰‡æ–‡ä»¶å¯¹åº”ä¸€æ¡è®°å½•\u0026#39;; åˆ†å—æ–‡ä»¶è¡¨å’Œåˆ†å—ä¸Šä¼ è¡¨æ˜¯ 1 to M çš„å…³ç³»ï¼Œå‡å¦‚å½“å‰æ–‡ä»¶åˆ†ä¸º10å—ã€‚åˆ™ä¼šå‡ºç°1ä¸ªåˆ†ç‰‡ä¸Šä¼ ä»»åŠ¡ï¼Œå’Œ10ä¸ªåˆ†ç‰‡æ–‡ä»¶è®°å½•ã€‚\n",
  "keywords": [
    "Java"
  ],
  "articleBody": "å¹¶å‘ä¸æ€§èƒ½ä¼˜åŒ– 1. å¤§æ–‡ä»¶ä¸Šä¼ å¦‚ä½•å¤„ç†ï¼Ÿåˆ†ç‰‡ä¸Šä¼  ç›¸å…³ä»£ç ï¼šhttps://github.com/SwimmingLiu/JavaSceneQuiz100/tree/main/lesson001\n1.1 ä¸ºä»€ä¹ˆéœ€è¦åˆ†ç‰‡ä¸Šä¼ ? å¤§æ–‡ä»¶åœ¨ä¸Šä¼ çš„è¿‡ç¨‹ä¸­ï¼Œè€—è´¹çš„æ—¶é—´æ¯”è¾ƒé•¿ã€‚å¦‚æœç½‘ç»œä¸ç¨³å®šï¼Œå¾ˆå¯èƒ½å¯¼è‡´ä¸Šä¼ å¤±è´¥ï¼Œéœ€è¦é‡æ–°ä¸Šä¼ ã€‚åˆ†ç‰‡ä¸Šä¼ ï¼Œå°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\nåˆ†ç‰‡ä¸Šä¼ å®šä¹‰ï¼šå°†å¤§æ–‡ä»¶æ‹†åˆ†ä¸ºä¸åŒçš„æ–‡ä»¶å—ï¼Œé€å—è¿›è¡Œä¸Šä¼ \n1.2 å¦‚ä½•å®ç°åˆ†ç‰‡ä¸Šä¼ ï¼Ÿ 1.2.1 å¦‚ä½•å­˜å‚¨åˆ†ç‰‡ä¿¡æ¯ åˆ†ç‰‡ä¸Šä¼ éœ€è¦è®°å½•æ–‡ä»¶çš„å±æ€§ (md5ã€å¤§å°ã€åç§°)ã€åˆ†ç‰‡æ•°é‡ã€æ–‡ä»¶å­˜å‚¨çš„å®Œæ•´è·¯å¾„ (æœ¬åœ°è·¯å¾„)ï¼Œè¿˜éœ€è¦è®°å½•æ¯ä¸ªåˆ†å—çš„ä¸Šä¼ æƒ…å†µ (åˆ†å—å¤§å°ã€åˆ†å—é¡ºåºã€åˆ†å—ä»»åŠ¡id)ã€‚å¯ä»¥ç”¨ åˆ†å—ä¸Šä¼ ä»»åŠ¡è¡¨ å’Œ åˆ†å—æ–‡ä»¶è¡¨ æ¥è®°å½•ã€‚\nåˆ†å—ä»»åŠ¡è¡¨ (t_shard_upload)\ncreate table if not exists t_shard_upload( id varchar(32) primary key, file_name varchar(256) not null comment 'æ–‡ä»¶åç§°', part_num int not null comment 'åˆ†ç‰‡æ•°é‡', md5 varchar(128) comment 'æ–‡ä»¶md5å€¼', file_full_path varchar(512) comment 'æ–‡ä»¶å®Œæ•´è·¯å¾„' ) comment = 'åˆ†ç‰‡ä¸Šä¼ ä»»åŠ¡è¡¨'; åˆ†å—æ–‡ä»¶è¡¨ (t_shard_upload_partï¼‰\ncreate table if not exists t_shard_upload_part( id varchar(32) primary key, shard_upload_id varchar(32) not null comment 'åˆ†ç‰‡ä»»åŠ¡idï¼ˆt_shard_upload.idï¼‰', part_order int not null comment 'ç¬¬å‡ ä¸ªåˆ†ç‰‡ï¼Œä»1å¼€å§‹', file_full_path varchar(512) comment 'æ–‡ä»¶å®Œæ•´è·¯å¾„', UNIQUE KEY `uq_part_order` (`shard_upload_id`,`part_order`) ) comment = 'åˆ†ç‰‡æ–‡ä»¶è¡¨ï¼Œæ¯ä¸ªåˆ†ç‰‡æ–‡ä»¶å¯¹åº”ä¸€æ¡è®°å½•'; åˆ†å—æ–‡ä»¶è¡¨å’Œåˆ†å—ä¸Šä¼ è¡¨æ˜¯ 1 to M çš„å…³ç³»ï¼Œå‡å¦‚å½“å‰æ–‡ä»¶åˆ†ä¸º10å—ã€‚åˆ™ä¼šå‡ºç°1ä¸ªåˆ†ç‰‡ä¸Šä¼ ä»»åŠ¡ï¼Œå’Œ10ä¸ªåˆ†ç‰‡æ–‡ä»¶è®°å½•ã€‚\n1.2.2 å¦‚ä½•å®šä¹‰åˆ†å—ä¸Šä¼ æ¥å£ åˆ†å—ä¸Šä¼ å¯ä»¥åˆ†ä¸ºä¸‹é¢ 5 ä¸ªæ¥å£\n**åˆ›å»ºåˆ†ç‰‡ä¸Šä¼ ä»»åŠ¡æ¥å£ ** (/shardUpload/init) å…¥å‚ï¼šæ–‡ä»¶åç§°ã€æ–‡ä»¶å¤§å°ã€æ–‡ä»¶md5 å‡ºå‚ï¼šä»»åŠ¡idã€åˆ†ç‰‡æ•°é‡ å®ç°ï¼šè®¡ç®—åˆ†ç‰‡æ•°é‡ï¼Œåˆ›å»ºåˆ†ç‰‡ä»»åŠ¡ ä¸Šä¼ åˆ†ç‰‡æ–‡ä»¶ (/shardUpload/uploadPart) å…¥å‚ï¼šMultiPartFile æ–‡ä»¶ å‡ºå‚ ï¼šåˆ†ç‰‡æ–‡ä»¶è®°å½•idã€ä»»åŠ¡id å®ç°ï¼šå­˜å…¥æ–‡ä»¶åˆ°ç£ç›˜è‡ªåŠ¨ä½ç½®ï¼Œåˆ›å»ºåˆ†ç‰‡æ–‡ä»¶è®°å½• åˆå¹¶åˆ†ç‰‡ã€å®Œæˆä¸Šä¼  (/shardUpload/complete) å…¥å‚ï¼šä»»åŠ¡id å‡ºå‚ï¼šå¸ƒå°”å€¼ å®ç°ï¼šæŒ‰ç…§é¡ºåºåˆå¹¶æ‰€æœ‰äºŒè¿›åˆ¶æ–‡ä»¶ è·å–åˆ†ç‰‡ä»»åŠ¡è¯¦ç»†ä¿¡æ¯(/shardUpload/detail) å…¥å‚ï¼šä»»åŠ¡id ã€æ–‡ä»¶md5 (äºŒé€‰ä¸€) å‡ºå‚ï¼šä»»åŠ¡è¿›åº¦ã€æ–‡ä»¶åç§°ã€æ–‡ä»¶md5 å®ç°ï¼šè¯»å–åˆ†ç‰‡æ–‡ä»¶è¡¨æŸ¥çœ‹ä¸Šä¼ æƒ…å†µ åŠŸèƒ½ï¼šè·å–åˆ†ç‰‡ä»»åŠ¡çš„çŠ¶æ€ä¿¡æ¯ï¼Œå¦‚åˆ†ç‰‡ä»»åŠ¡æ˜¯å¦ä¸Šä¼ å®Œæ¯•ï¼Œå“ªäº›åˆ†ç‰‡å·²ä¸Šä¼ ç­‰ä¿¡æ¯ï¼Œç½‘ç»œå‡ºç°æ•…éšœï¼Œå¯ä»¥å€ŸåŠ©æ­¤æ¥å£æ¢å¤ä¸Šä¼  1.3 å¦‚æœä¸Šä¼ è¿‡ç¨‹ä¸­ï¼Œå‡ºç°æ•…éšœå¦‚ä½•å¤„ç†ï¼Ÿ æƒ…å†µ1ï¼šæµè§ˆå™¨æ— æ³•è¯»å–åˆšæ‰ç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶äº† æ­¤æ—¶éœ€è¦ç”¨æˆ·é‡æ–°é€‰æ‹©æ–‡ä»¶ï¼Œé‡æ–°ä¸Šä¼ ã€‚è¿™ä¸ªåœ°æ–¹ä¹Ÿå¯ä»¥ç»™å¤§å®¶æä¾›å¦å¤–ä¸€ç§æ€è·¯ï¼Œç¬¬1ä¸ªæ¥å£åˆ›å»ºåˆ†ç‰‡ä»»åŠ¡çš„æ—¶å€™ä¼ å…¥äº†æ–‡ä»¶çš„md5ï¼ŒæŒ‰è¯´è¿™ä¸ªå€¼æ˜¯å…·æœ‰å”¯ä¸€æ€§çš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡è¿™ä¸ªå€¼æ‰¾åˆ°åˆšæ‰çš„ä»»åŠ¡ï¼ŒæŒ‰ç…§è¿™ç§æ€è·¯ï¼Œå°±éœ€è¦åç«¯æä¾›ä¸€ä¸ªæ–°çš„æ¥å£ï¼šé€šè¿‡æ–‡ä»¶çš„md5å€¼æ‰¾åˆ°åˆšæ‰å¤±è´¥çš„é‚£ä¸ªä»»åŠ¡ï¼Œç„¶åç»§ç»­ä¸Šä¼ æœªä¸Šä¼ çš„åˆ†ç‰‡ã€‚\næƒ…å†µ2ï¼šæµè§ˆå™¨å¯ä»¥ç»§ç»­è¯»å–åˆšæ‰ç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶ è¿™ç§æƒ…å†µï¼Œå¯ä»¥å…ˆè°ƒç”¨ç¬¬4ä¸ªæ¥å£ï¼Œé€šè¿‡æ­¤æ¥å£å¯ä»¥çŸ¥é“é‚£äº›åˆ†ç‰‡è¿˜æœªä¸Šä¼ ï¼Œç„¶åç»§ç»­ä¸Šä¼ è¿™äº›åˆ†ç‰‡å°±å¯ä»¥äº†ã€‚\n2. å¤šçº¿ç¨‹ä»»åŠ¡æ‰¹å¤„ç†é€šç”¨å·¥å…·ç±» ç›¸å…³ä»£ç ï¼šhttps://github.com/SwimmingLiu/JavaSceneQuiz100/tree/main/lesson002\nä½¿ç”¨çº¿ç¨‹æ± æ‰¹é‡å‘é€çŸ­ä¿¡ï¼Œå½“çŸ­ä¿¡å‘é€å®Œæ¯•ä¹‹åï¼Œè®°å½•è€—æ—¶æƒ…å†µ\nåºŸè¯ä¸å¤šè¯´ï¼Œ ç›´æ¥çœ‹ä»£ç  ã€ä¸»è¦çŸ¥è¯†ç‚¹ã€‘\nCountDownLatchï¼šå¦‚æœæƒ³è¦ç­‰å¼‚æ­¥çº¿ç¨‹æ‰§è¡Œä¹‹åï¼Œå†ç»§ç»­å›åˆ°åŸæ–¹æ³•ä¸­ï¼Œå¯ä»¥ä½¿ç”¨CountDownLatch Executorsï¼šç”¨äºåˆ›å»ºçº¿ç¨‹æ± ï¼Œé‡å†™ executor.execute ä¸­çš„ Runnable æ–¹æ³•ï¼Œå¯å®ç°å¼‚æ­¥æ‰§è¡Œçº¿ç¨‹ public class TaskDisposeUtils { /** * ä½¿ç”¨çº¿ç¨‹æ± æ‰¹å¤„ç†æ–‡ä»¶ï¼Œå½“æ‰€æœ‰ä»»åŠ¡å¤„ç†å®Œæ¯•åæ‰ä¼šè¿”å› * * @param taskList ä»»åŠ¡åˆ—è¡¨ * @param consumer å¤„ç†ä»»åŠ¡çš„æ–¹æ³• * @param executor çº¿ç¨‹æ±  * @param * @throws InterruptedException */ public static \u003cT\u003e void dispose(List\u003cT\u003e taskList, Consumer\u003c? super T\u003e consumer, Executor executor) throws InterruptedException { if (taskList == null || taskList.isEmpty() || consumer == null) return; CountDownLatch latch = new CountDownLatch(taskList.size()); for (T item : taskList) { executor.execute(() -\u003e { try { consumer.accept(item); } finally { latch.countDown(); } }); } latch.await(); } public static void main(String[] args) throws InterruptedException { long startTime = System.currentTimeMillis(); List\u003cString\u003e taskList = List.of(\"çŸ­ä¿¡-1\", \"çŸ­ä¿¡-2\", \"çŸ­ä¿¡-3\"); ExecutorService executor = Executors.newFixedThreadPool(10); dispose(taskList, TaskDisposeUtils::doTask, executor); System.out.println(\"ä»»åŠ¡å¤„ç†å®Œæ¯•,è€—æ—¶(ms):\" + (System.currentTimeMillis() - startTime)); executor.shutdown(); } public static void doTask(String task) { System.out.println(task + \"å‘é€æˆåŠŸ\"); try { TimeUnit.SECONDS.sleep(1); } catch (InterruptedException e) { Thread.currentThread().interrupt(); } } } 3. æ¥å£æ€§èƒ½å‹åŠ›æµ‹è¯•å·¥å…· ç›¸å…³ä»£ç ï¼šhttps://github.com/SwimmingLiu/JavaSceneQuiz100/tree/main/lesson003\n3.1 å¸¸ç”¨å‹æµ‹å·¥å…·ç±» Jemeter ã€LoadRunnerã€ApiFox - è‡ªåŠ¨åŒ–æµ‹è¯•\nã€æ³¨æ„ã€‘LoadRunner åªæœ‰windowå¯ä»¥ç”¨\n3.2 æ‰‹å†™å‹æµ‹å·¥å…·ç±» åºŸè¯ä¸å¤šè¯´ï¼Œçœ‹ä»£ç \nã€ä¸»è¦çŸ¥è¯†ç‚¹ã€‘\nä¸ºä»€ä¹ˆ updateFastestTime æ–¹æ³•éœ€è¦ä½¿ç”¨å¾ªç¯è€Œä¸æ˜¯ç›´æ¥ compareAndSet ï¼šå› ä¸ºç›´æ¥ä½¿ç”¨ compareAndSet ä¼šå‡ºç°çº¿ç¨‹ä¸å®‰å…¨çš„æƒ…å†µï¼Œæ¯”å¦‚ä¸‹é¢çš„æƒ…å†µ\n// é”™è¯¯çš„åšæ³•ï¼ˆéçº¿ç¨‹å®‰å…¨ï¼‰ int current = fastestCostTime.get(); // çº¿ç¨‹Aè¯»å–åˆ°å€¼100 if (current \u003e costTime) { // çº¿ç¨‹Aåˆ¤æ–­100 \u003e 30ï¼Œå‡†å¤‡æ›´æ–° // æ­¤æ—¶çº¿ç¨‹Bä¹Ÿè¯»å–åˆ°100ï¼Œä¹Ÿåˆ¤æ–­100 \u003e 50ï¼Œä¹Ÿå‡†å¤‡æ›´æ–° fastestCostTime.set(costTime); // çº¿ç¨‹Aè®¾ç½®ä¸º30 // çº¿ç¨‹Bè®¾ç½®ä¸º50ï¼Œè¦†ç›–äº†çº¿ç¨‹Açš„ç»“æœ (æœ€å°æ—¶é—´åº”è¯¥æ˜¯30s) } // ä½¿ç”¨whileå¾ªç¯ä¿è¯çº¿ç¨‹å®‰å…¨ ï¼ˆå…¶å®å°±æ˜¯CASï¼‰ while (true){ int fsCostTime = fastestCostTime.get(); // çº¿ç¨‹Aè¯»å–åˆ°100 // çº¿ç¨‹Bæ­¤æ—¶å°†å€¼æ”¹ä¸º90 if (fastestCostTime.compareAndSet(fsCostTime, costTime)) { // çº¿ç¨‹Aå°è¯•å°†100æ”¹ä¸º50 // å¤±è´¥ï¼å› ä¸ºå½“å‰å€¼å·²ç»æ˜¯90ï¼Œä¸ç­‰äºé¢„æœŸçš„100 break; } // ç»§ç»­å¾ªç¯ï¼Œé‡æ–°è·å–æœ€æ–°å€¼90ï¼Œå†æ¬¡å°è¯• } çº¿ç¨‹æ± å‚æ•°ï¼šæ•°ä¾æ¬¡ä¸º coolPoolSize ã€maxPoolSizeã€keepAliveTimeã€TimeUnitã€waitQueue ç­‰å¾…é˜Ÿåˆ—\nä¸ºä»€ä¹ˆçº¿ç¨‹éœ€è¦é¢„çƒ­ï¼šé¢„çƒ­æ˜¯ä¸ºäº†é¿å…çº¿ç¨‹åˆ›å»ºæ—¶å¸¦æ¥çš„é¢å¤–å¼€é”€ï¼Œå¦‚æœä¸é¢„çƒ­ï¼Œå¾ˆå¯èƒ½å‰ 100 ä¸ªæ ¸å¿ƒçº¿ç¨‹éœ€è¦å¤šæ¶ˆè€— 10~50 ms æ¥åˆ›å»ºçº¿ç¨‹\nAtomicIntegerï¼šé˜²æ­¢å¤šçº¿ç¨‹ä¿®æ”¹åŒä¸€æ•°æ®æ—¶ï¼Œå‡ºç°çº¿ç¨‹ä¸å®‰å…¨çš„æƒ…å†µ\n// æ™®é€šIntegerçš„é—®é¢˜ int value = counter; // 1. è¯»å– value = value + 1; // 2. ä¿®æ”¹ counter = value; // 3. å†™å…¥ // è¿™ä¸‰æ­¥ä¸æ˜¯åŸå­çš„ï¼Œå¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä¸­æ–­ // AtomicIntegeré‡‡ç”¨CAS + volatile ä¿è¯åŸå­æ€§ atomicCounter.incrementAndGet(); // åŸå­æ“ä½œ public class LoadRunnerUtils { public static class LoadRunnerResult { private int requests; // è¯·æ±‚æ€»æ•° private int concurrency; // å¹¶å‘é‡ private int successRequests; // æˆåŠŸè¯·æ±‚æ•° private int failRequests; // å¤±è´¥è¯·æ±‚æ•° private int timeTakenForTests; // è¯·æ±‚æ€»è€—æ—¶(ms) private float requestsPerSecond; // æ¯ç§’è¯·æ±‚æ•°ï¼ˆååé‡ï¼‰ private float timePerRequest; // æ¯ä¸ªè¯·æ±‚å¹³å‡è€—æ—¶(ms) private float fastestCostTime; // æœ€å¿«çš„è¯·æ±‚è€—æ—¶(ms) private float slowestCostTime; // æœ€æ…¢çš„è¯·æ±‚è€—æ—¶(ms) } /** * æ‰§è¡Œå¹¶å‘å‹åŠ›æµ‹è¯• * @param requests æ€»è¯·æ±‚æ•° * @param concurrency å¹¶å‘æ•°é‡ * @param command è¢«æµ‹è¯•çš„ä»£ç  * @return å‹æµ‹ç»“æœ */ public static LoadRunnerResult run(int requests, int concurrency, Runnable command) throws InterruptedException { log.info(\"å‹æµ‹å¼€å§‹......\"); // åˆ›å»ºå›ºå®šå¤§å°çš„çº¿ç¨‹æ± ï¼Œé¢„çƒ­æ‰€æœ‰æ ¸å¿ƒçº¿ç¨‹ ThreadPoolExecutor executor = createThreadPool(concurrency); // ç”¨äºç­‰å¾…æ‰€æœ‰è¯·æ±‚å®Œæˆçš„åŒæ­¥å™¨ CountDownLatch latch = new CountDownLatch(requests); // ç»Ÿè®¡æ•°æ®ï¼ˆä½¿ç”¨åŸå­ç±»ä¿è¯çº¿ç¨‹å®‰å…¨ï¼‰ AtomicInteger successCount = new AtomicInteger(0); AtomicInteger fastestTime = new AtomicInteger(Integer.MAX_VALUE); AtomicInteger slowestTime = new AtomicInteger(Integer.MIN_VALUE); long startTime = System.currentTimeMillis(); // æäº¤æ‰€æœ‰å‹æµ‹ä»»åŠ¡ for (int i = 0; i \u003c requests; i++) { executor.execute(() -\u003e executeRequest(command, successCount, fastestTime, slowestTime, latch)); } // ç­‰å¾…æ‰€æœ‰è¯·æ±‚å®Œæˆ latch.await(); executor.shutdown(); long endTime = System.currentTimeMillis(); log.info(\"å‹æµ‹ç»“æŸï¼Œæ€»è€—æ—¶(ms):{}\", (endTime - startTime)); // è¿”å›å‹æµ‹ç»“æœ } /** * åˆ›å»ºçº¿ç¨‹æ± å¹¶é¢„çƒ­æ ¸å¿ƒçº¿ç¨‹ */ private static ThreadPoolExecutor createThreadPool(int concurrency) { // å‚æ•°ä¾æ¬¡ä¸º coolPoolSizeã€maxPoolSizeã€keepAliveTimeã€TimeUnitã€ç­‰å¾…é˜Ÿåˆ— ThreadPoolExecutor executor = new ThreadPoolExecutor(concurrency, concurrency, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue\u003c\u003e()); executor.prestartAllCoreThreads(); return executor; } /** * æ‰§è¡Œå•ä¸ªè¯·æ±‚å¹¶ç»Ÿè®¡ç»“æœ */ private static void executeRequest(Runnable command, AtomicInteger successCount, AtomicInteger fastestTime, AtomicInteger slowestTime, CountDownLatch latch) { try { long requestStart = System.currentTimeMillis(); command.run(); // æ‰§è¡Œè¢«æµ‹è¯•çš„æ–¹æ³• int costTime = (int)(System.currentTimeMillis() - requestStart); // æ›´æ–°ç»Ÿè®¡æ•°æ® updateFastestTime(fastestTime, costTime); updateSlowestTime(slowestTime, costTime); successCount.incrementAndGet(); } catch (Exception e) { log.error(\"è¯·æ±‚æ‰§è¡Œå¤±è´¥: {}\", e.getMessage()); } finally { latch.countDown(); // æ ‡è®°å½“å‰è¯·æ±‚å®Œæˆ } } /** * åŸå­æ›´æ–°æœ€å¿«è€—æ—¶ */ private static void updateFastestTime(AtomicInteger fastestTime, int costTime) { while (true) { int current = fastestTime.get(); if (current \u003c= costTime || fastestTime.compareAndSet(current, costTime)) { break; } } } } ",
  "wordCount" : "669",
  "inLanguage": "en",
  "image": "https://swimmingliu.cn/papermod-cover.png","datePublished": "2025-07-06T13:27:35+08:00",
  "dateModified": "2025-07-06T13:27:35+08:00",
  "author":[{
    "@type": "Person",
    "name": "SwimmingLiu"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://swimmingliu.cn/posts/job/java-scene-quiz-100/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "SwimmingLiu's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://swimmingliu.cn/images/swimmingliu_icon.png"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://swimmingliu.cn/" accesskey="h" title="ğ“¢ğ”€ğ“²ğ“¶ğ“¶ğ“²ğ“·ğ“°ğ“›ğ“²ğ“¾&#39;ğ“¼ ğ“‘ğ“µğ“¸ğ“° (Alt + H)">
                <img src="https://swimmingliu.cn/images/swimmingliu_icon.png" alt="" aria-label="logo"
                    height="30">ğ“¢ğ”€ğ“²ğ“¶ğ“¶ğ“²ğ“·ğ“°ğ“›ğ“²ğ“¾&#39;ğ“¼ ğ“‘ğ“µğ“¸ğ“°</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://swimmingliu.cn/index.html" title="ğŸ¡ Home">
                    <span>ğŸ¡ Home</span>
                </a>
            </li>
            <li>
                <a href="https://swimmingliu.cn/search/" title="ğŸ” Search">
                    <span>ğŸ” Search</span>
                </a>
            </li>
            <li>
                <a href="https://swimmingliu.cn/posts/" title="ğŸ—’ï¸ Posts">
                    <span>ğŸ—’ï¸ Posts</span>
                </a>
            </li>
            <li>
                <a href="https://swimmingliu.cn/archives/" title="ğŸ“ƒ Archive">
                    <span>ğŸ“ƒ Archive</span>
                </a>
            </li>
            <li>
                <a href="https://swimmingliu.cn/tags/" title="ğŸ“‘ Tags">
                    <span>ğŸ“‘ Tags</span>
                </a>
            </li>
            <li>
                <a href="https://bento.me/swimmingliu" title="ğŸ‘¨ğŸ»â€ğŸ“ About Me">
                    <span>ğŸ‘¨ğŸ»â€ğŸ“ About Me</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
            <li>
                <a href="https://www.emojisearch.app/" title="Emoji">
                    <span>Emoji</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://swimmingliu.cn/">Home</a>&nbsp;Â»&nbsp;<a href="https://swimmingliu.cn/posts/">ğŸ“š Posts</a>&nbsp;Â»&nbsp;<a href="https://swimmingliu.cn/posts/job/">ğŸ’» Job</a></div>
    <h1 class="post-title entry-hint-parent">
      Javaåœºæ™¯100é¢˜
    </h1>
    <div class="post-meta"><span title='2025-07-06 13:27:35 +0800 +0800'>July 6, 2025</span>&nbsp;Â·&nbsp;4 min&nbsp;Â·&nbsp;SwimmingLiu

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e5%b9%b6%e5%8f%91%e4%b8%8e%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96" aria-label="å¹¶å‘ä¸æ€§èƒ½ä¼˜åŒ–">å¹¶å‘ä¸æ€§èƒ½ä¼˜åŒ–</a><ul>
                        
                <li>
                    <a href="#1-%e5%a4%a7%e6%96%87%e4%bb%b6%e4%b8%8a%e4%bc%a0%e5%a6%82%e4%bd%95%e5%a4%84%e7%90%86%e5%88%86%e7%89%87%e4%b8%8a%e4%bc%a0" aria-label="1. å¤§æ–‡ä»¶ä¸Šä¼ å¦‚ä½•å¤„ç†ï¼Ÿåˆ†ç‰‡ä¸Šä¼ ">1. å¤§æ–‡ä»¶ä¸Šä¼ å¦‚ä½•å¤„ç†ï¼Ÿåˆ†ç‰‡ä¸Šä¼ </a><ul>
                        
                <li>
                    <a href="#11-%e4%b8%ba%e4%bb%80%e4%b9%88%e9%9c%80%e8%a6%81%e5%88%86%e7%89%87%e4%b8%8a%e4%bc%a0" aria-label="1.1 ä¸ºä»€ä¹ˆéœ€è¦åˆ†ç‰‡ä¸Šä¼ ?">1.1 ä¸ºä»€ä¹ˆéœ€è¦åˆ†ç‰‡ä¸Šä¼ ?</a></li>
                <li>
                    <a href="#12-%e5%a6%82%e4%bd%95%e5%ae%9e%e7%8e%b0%e5%88%86%e7%89%87%e4%b8%8a%e4%bc%a0" aria-label="1.2 å¦‚ä½•å®ç°åˆ†ç‰‡ä¸Šä¼ ï¼Ÿ">1.2 å¦‚ä½•å®ç°åˆ†ç‰‡ä¸Šä¼ ï¼Ÿ</a><ul>
                        
                <li>
                    <a href="#121-%e5%a6%82%e4%bd%95%e5%ad%98%e5%82%a8%e5%88%86%e7%89%87%e4%bf%a1%e6%81%af" aria-label="1.2.1 å¦‚ä½•å­˜å‚¨åˆ†ç‰‡ä¿¡æ¯">1.2.1 å¦‚ä½•å­˜å‚¨åˆ†ç‰‡ä¿¡æ¯</a></li>
                <li>
                    <a href="#122-%e5%a6%82%e4%bd%95%e5%ae%9a%e4%b9%89%e5%88%86%e5%9d%97%e4%b8%8a%e4%bc%a0%e6%8e%a5%e5%8f%a3" aria-label="1.2.2 å¦‚ä½•å®šä¹‰åˆ†å—ä¸Šä¼ æ¥å£">1.2.2 å¦‚ä½•å®šä¹‰åˆ†å—ä¸Šä¼ æ¥å£</a></li></ul>
                </li>
                <li>
                    <a href="#13-%e5%a6%82%e6%9e%9c%e4%b8%8a%e4%bc%a0%e8%bf%87%e7%a8%8b%e4%b8%ad%e5%87%ba%e7%8e%b0%e6%95%85%e9%9a%9c%e5%a6%82%e4%bd%95%e5%a4%84%e7%90%86" aria-label="1.3 å¦‚æœä¸Šä¼ è¿‡ç¨‹ä¸­ï¼Œå‡ºç°æ•…éšœå¦‚ä½•å¤„ç†ï¼Ÿ">1.3 å¦‚æœä¸Šä¼ è¿‡ç¨‹ä¸­ï¼Œå‡ºç°æ•…éšœå¦‚ä½•å¤„ç†ï¼Ÿ</a><ul>
                        
                <li>
                    <a href="#%e6%83%85%e5%86%b51%e6%b5%8f%e8%a7%88%e5%99%a8%e6%97%a0%e6%b3%95%e8%af%bb%e5%8f%96%e5%88%9a%e6%89%8d%e7%94%a8%e6%88%b7%e9%80%89%e6%8b%a9%e7%9a%84%e6%96%87%e4%bb%b6%e4%ba%86" aria-label="æƒ…å†µ1ï¼šæµè§ˆå™¨æ— æ³•è¯»å–åˆšæ‰ç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶äº†">æƒ…å†µ1ï¼šæµè§ˆå™¨æ— æ³•è¯»å–åˆšæ‰ç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶äº†</a></li>
                <li>
                    <a href="#%e6%83%85%e5%86%b52%e6%b5%8f%e8%a7%88%e5%99%a8%e5%8f%af%e4%bb%a5%e7%bb%a7%e7%bb%ad%e8%af%bb%e5%8f%96%e5%88%9a%e6%89%8d%e7%94%a8%e6%88%b7%e9%80%89%e6%8b%a9%e7%9a%84%e6%96%87%e4%bb%b6" aria-label="æƒ…å†µ2ï¼šæµè§ˆå™¨å¯ä»¥ç»§ç»­è¯»å–åˆšæ‰ç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶">æƒ…å†µ2ï¼šæµè§ˆå™¨å¯ä»¥ç»§ç»­è¯»å–åˆšæ‰ç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#2-%e5%a4%9a%e7%ba%bf%e7%a8%8b%e4%bb%bb%e5%8a%a1%e6%89%b9%e5%a4%84%e7%90%86%e9%80%9a%e7%94%a8%e5%b7%a5%e5%85%b7%e7%b1%bb" aria-label="2. å¤šçº¿ç¨‹ä»»åŠ¡æ‰¹å¤„ç†é€šç”¨å·¥å…·ç±»">2. å¤šçº¿ç¨‹ä»»åŠ¡æ‰¹å¤„ç†é€šç”¨å·¥å…·ç±»</a></li>
                <li>
                    <a href="#3-%e6%8e%a5%e5%8f%a3%e6%80%a7%e8%83%bd%e5%8e%8b%e5%8a%9b%e6%b5%8b%e8%af%95%e5%b7%a5%e5%85%b7" aria-label="3. æ¥å£æ€§èƒ½å‹åŠ›æµ‹è¯•å·¥å…·">3. æ¥å£æ€§èƒ½å‹åŠ›æµ‹è¯•å·¥å…·</a><ul>
                        
                <li>
                    <a href="#31-%e5%b8%b8%e7%94%a8%e5%8e%8b%e6%b5%8b%e5%b7%a5%e5%85%b7%e7%b1%bb" aria-label="3.1 å¸¸ç”¨å‹æµ‹å·¥å…·ç±»">3.1 å¸¸ç”¨å‹æµ‹å·¥å…·ç±»</a></li>
                <li>
                    <a href="#32-%e6%89%8b%e5%86%99%e5%8e%8b%e6%b5%8b%e5%b7%a5%e5%85%b7%e7%b1%bb" aria-label="3.2 æ‰‹å†™å‹æµ‹å·¥å…·ç±»">3.2 æ‰‹å†™å‹æµ‹å·¥å…·ç±»</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>
  <div class="post-content"><h1 id="å¹¶å‘ä¸æ€§èƒ½ä¼˜åŒ–">å¹¶å‘ä¸æ€§èƒ½ä¼˜åŒ–<a hidden class="anchor" aria-hidden="true" href="#å¹¶å‘ä¸æ€§èƒ½ä¼˜åŒ–">#</a></h1>
<h2 id="1-å¤§æ–‡ä»¶ä¸Šä¼ å¦‚ä½•å¤„ç†åˆ†ç‰‡ä¸Šä¼ ">1. å¤§æ–‡ä»¶ä¸Šä¼ å¦‚ä½•å¤„ç†ï¼Ÿåˆ†ç‰‡ä¸Šä¼ <a hidden class="anchor" aria-hidden="true" href="#1-å¤§æ–‡ä»¶ä¸Šä¼ å¦‚ä½•å¤„ç†åˆ†ç‰‡ä¸Šä¼ ">#</a></h2>
<p>ç›¸å…³ä»£ç ï¼š<a href="https://github.com/SwimmingLiu/JavaSceneQuiz100/tree/main/lesson001">https://github.com/SwimmingLiu/JavaSceneQuiz100/tree/main/lesson001</a></p>
<h3 id="11-ä¸ºä»€ä¹ˆéœ€è¦åˆ†ç‰‡ä¸Šä¼ ">1.1 ä¸ºä»€ä¹ˆéœ€è¦åˆ†ç‰‡ä¸Šä¼ ?<a hidden class="anchor" aria-hidden="true" href="#11-ä¸ºä»€ä¹ˆéœ€è¦åˆ†ç‰‡ä¸Šä¼ ">#</a></h3>
<p>å¤§æ–‡ä»¶åœ¨ä¸Šä¼ çš„è¿‡ç¨‹ä¸­ï¼Œè€—è´¹çš„æ—¶é—´æ¯”è¾ƒé•¿ã€‚å¦‚æœç½‘ç»œä¸ç¨³å®šï¼Œå¾ˆå¯èƒ½å¯¼è‡´ä¸Šä¼ å¤±è´¥ï¼Œéœ€è¦é‡æ–°ä¸Šä¼ ã€‚åˆ†ç‰‡ä¸Šä¼ ï¼Œå°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p><strong>åˆ†ç‰‡ä¸Šä¼ å®šä¹‰</strong>ï¼šå°†å¤§æ–‡ä»¶æ‹†åˆ†ä¸ºä¸åŒçš„æ–‡ä»¶å—ï¼Œé€å—è¿›è¡Œä¸Šä¼ </p>
<h3 id="12-å¦‚ä½•å®ç°åˆ†ç‰‡ä¸Šä¼ ">1.2 å¦‚ä½•å®ç°åˆ†ç‰‡ä¸Šä¼ ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#12-å¦‚ä½•å®ç°åˆ†ç‰‡ä¸Šä¼ ">#</a></h3>
<h4 id="121-å¦‚ä½•å­˜å‚¨åˆ†ç‰‡ä¿¡æ¯">1.2.1 å¦‚ä½•å­˜å‚¨åˆ†ç‰‡ä¿¡æ¯<a hidden class="anchor" aria-hidden="true" href="#121-å¦‚ä½•å­˜å‚¨åˆ†ç‰‡ä¿¡æ¯">#</a></h4>
<p>åˆ†ç‰‡ä¸Šä¼ éœ€è¦è®°å½•æ–‡ä»¶çš„å±æ€§ (md5ã€å¤§å°ã€åç§°)ã€åˆ†ç‰‡æ•°é‡ã€æ–‡ä»¶å­˜å‚¨çš„å®Œæ•´è·¯å¾„ (æœ¬åœ°è·¯å¾„)ï¼Œè¿˜éœ€è¦è®°å½•æ¯ä¸ªåˆ†å—çš„ä¸Šä¼ æƒ…å†µ (åˆ†å—å¤§å°ã€åˆ†å—é¡ºåºã€åˆ†å—ä»»åŠ¡id)ã€‚å¯ä»¥ç”¨ <strong>åˆ†å—ä¸Šä¼ ä»»åŠ¡è¡¨</strong> å’Œ <strong>åˆ†å—æ–‡ä»¶è¡¨</strong> æ¥è®°å½•ã€‚</p>
<ol>
<li>
<p><strong>åˆ†å—ä»»åŠ¡è¡¨ (t_shard_upload)</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="n">t_shard_upload</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">file_name</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ–‡ä»¶åç§°&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">part_num</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;åˆ†ç‰‡æ•°é‡&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">md5</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ–‡ä»¶md5å€¼&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">file_full_path</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ–‡ä»¶å®Œæ•´è·¯å¾„&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;åˆ†ç‰‡ä¸Šä¼ ä»»åŠ¡è¡¨&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p><strong>åˆ†å—æ–‡ä»¶è¡¨ (t_shard_upload_partï¼‰</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">exists</span><span class="w">  </span><span class="n">t_shard_upload_part</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">shard_upload_id</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;åˆ†ç‰‡ä»»åŠ¡idï¼ˆt_shard_upload.idï¼‰&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">part_order</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;ç¬¬å‡ ä¸ªåˆ†ç‰‡ï¼Œä»1å¼€å§‹&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">file_full_path</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ–‡ä»¶å®Œæ•´è·¯å¾„&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="o">`</span><span class="n">uq_part_order</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">shard_upload_id</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">part_order</span><span class="o">`</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;åˆ†ç‰‡æ–‡ä»¶è¡¨ï¼Œæ¯ä¸ªåˆ†ç‰‡æ–‡ä»¶å¯¹åº”ä¸€æ¡è®°å½•&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div></li>
</ol>
<p>åˆ†å—æ–‡ä»¶è¡¨å’Œåˆ†å—ä¸Šä¼ è¡¨æ˜¯ <strong>1 to M</strong> çš„å…³ç³»ï¼Œå‡å¦‚å½“å‰æ–‡ä»¶åˆ†ä¸º<strong>10</strong>å—ã€‚åˆ™ä¼šå‡ºç°<strong>1</strong>ä¸ªåˆ†ç‰‡ä¸Šä¼ ä»»åŠ¡ï¼Œå’Œ<strong>10</strong>ä¸ªåˆ†ç‰‡æ–‡ä»¶è®°å½•ã€‚</p>
<h4 id="122-å¦‚ä½•å®šä¹‰åˆ†å—ä¸Šä¼ æ¥å£">1.2.2 å¦‚ä½•å®šä¹‰åˆ†å—ä¸Šä¼ æ¥å£<a hidden class="anchor" aria-hidden="true" href="#122-å¦‚ä½•å®šä¹‰åˆ†å—ä¸Šä¼ æ¥å£">#</a></h4>
<p>åˆ†å—ä¸Šä¼ å¯ä»¥åˆ†ä¸ºä¸‹é¢ 5 ä¸ªæ¥å£</p>
<ol>
<li>**åˆ›å»ºåˆ†ç‰‡ä¸Šä¼ ä»»åŠ¡æ¥å£ ** (<code>/shardUpload/init</code>)
<ul>
<li>å…¥å‚ï¼šæ–‡ä»¶åç§°ã€æ–‡ä»¶å¤§å°ã€æ–‡ä»¶md5</li>
<li>å‡ºå‚ï¼šä»»åŠ¡idã€åˆ†ç‰‡æ•°é‡</li>
<li>å®ç°ï¼šè®¡ç®—åˆ†ç‰‡æ•°é‡ï¼Œåˆ›å»ºåˆ†ç‰‡ä»»åŠ¡</li>
</ul>
</li>
<li><strong>ä¸Šä¼ åˆ†ç‰‡æ–‡ä»¶</strong> (<code>/shardUpload/uploadPart</code>)
<ul>
<li>å…¥å‚ï¼šMultiPartFile æ–‡ä»¶</li>
<li>å‡ºå‚ ï¼šåˆ†ç‰‡æ–‡ä»¶è®°å½•idã€ä»»åŠ¡id</li>
<li>å®ç°ï¼šå­˜å…¥æ–‡ä»¶åˆ°ç£ç›˜è‡ªåŠ¨ä½ç½®ï¼Œåˆ›å»ºåˆ†ç‰‡æ–‡ä»¶è®°å½•</li>
</ul>
</li>
<li>åˆå¹¶åˆ†ç‰‡ã€å®Œæˆä¸Šä¼  (<code>/shardUpload/complete</code>)
<ul>
<li>å…¥å‚ï¼šä»»åŠ¡id</li>
<li>å‡ºå‚ï¼šå¸ƒå°”å€¼</li>
<li>å®ç°ï¼šæŒ‰ç…§é¡ºåºåˆå¹¶æ‰€æœ‰äºŒè¿›åˆ¶æ–‡ä»¶</li>
</ul>
</li>
<li>è·å–åˆ†ç‰‡ä»»åŠ¡è¯¦ç»†ä¿¡æ¯(<code>/shardUpload/detail</code>)
<ul>
<li>å…¥å‚ï¼šä»»åŠ¡id ã€æ–‡ä»¶md5 (äºŒé€‰ä¸€)</li>
<li>å‡ºå‚ï¼šä»»åŠ¡è¿›åº¦ã€æ–‡ä»¶åç§°ã€æ–‡ä»¶md5</li>
<li>å®ç°ï¼šè¯»å–åˆ†ç‰‡æ–‡ä»¶è¡¨æŸ¥çœ‹ä¸Šä¼ æƒ…å†µ</li>
<li>åŠŸèƒ½ï¼šè·å–åˆ†ç‰‡ä»»åŠ¡çš„çŠ¶æ€ä¿¡æ¯ï¼Œå¦‚åˆ†ç‰‡ä»»åŠ¡æ˜¯å¦ä¸Šä¼ å®Œæ¯•ï¼Œå“ªäº›åˆ†ç‰‡å·²ä¸Šä¼ ç­‰ä¿¡æ¯ï¼Œç½‘ç»œå‡ºç°æ•…éšœï¼Œå¯ä»¥å€ŸåŠ©æ­¤æ¥å£æ¢å¤ä¸Šä¼ </li>
</ul>
</li>
</ol>
<h3 id="13-å¦‚æœä¸Šä¼ è¿‡ç¨‹ä¸­å‡ºç°æ•…éšœå¦‚ä½•å¤„ç†">1.3 å¦‚æœä¸Šä¼ è¿‡ç¨‹ä¸­ï¼Œå‡ºç°æ•…éšœå¦‚ä½•å¤„ç†ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#13-å¦‚æœä¸Šä¼ è¿‡ç¨‹ä¸­å‡ºç°æ•…éšœå¦‚ä½•å¤„ç†">#</a></h3>
<h4 id="æƒ…å†µ1æµè§ˆå™¨æ— æ³•è¯»å–åˆšæ‰ç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶äº†">æƒ…å†µ1ï¼šæµè§ˆå™¨æ— æ³•è¯»å–åˆšæ‰ç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶äº†<a hidden class="anchor" aria-hidden="true" href="#æƒ…å†µ1æµè§ˆå™¨æ— æ³•è¯»å–åˆšæ‰ç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶äº†">#</a></h4>
<p>æ­¤æ—¶éœ€è¦ç”¨æˆ·é‡æ–°é€‰æ‹©æ–‡ä»¶ï¼Œé‡æ–°ä¸Šä¼ ã€‚è¿™ä¸ªåœ°æ–¹ä¹Ÿå¯ä»¥ç»™å¤§å®¶æä¾›å¦å¤–ä¸€ç§æ€è·¯ï¼Œç¬¬1ä¸ªæ¥å£åˆ›å»ºåˆ†ç‰‡ä»»åŠ¡çš„æ—¶å€™ä¼ å…¥äº†æ–‡ä»¶çš„md5ï¼ŒæŒ‰è¯´è¿™ä¸ªå€¼æ˜¯å…·æœ‰å”¯ä¸€æ€§çš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡è¿™ä¸ªå€¼æ‰¾åˆ°åˆšæ‰çš„ä»»åŠ¡ï¼ŒæŒ‰ç…§è¿™ç§æ€è·¯ï¼Œå°±éœ€è¦åç«¯æä¾›ä¸€ä¸ªæ–°çš„æ¥å£ï¼šé€šè¿‡æ–‡ä»¶çš„md5å€¼æ‰¾åˆ°åˆšæ‰å¤±è´¥çš„é‚£ä¸ªä»»åŠ¡ï¼Œç„¶åç»§ç»­ä¸Šä¼ æœªä¸Šä¼ çš„åˆ†ç‰‡ã€‚</p>
<h4 id="æƒ…å†µ2æµè§ˆå™¨å¯ä»¥ç»§ç»­è¯»å–åˆšæ‰ç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶">æƒ…å†µ2ï¼šæµè§ˆå™¨å¯ä»¥ç»§ç»­è¯»å–åˆšæ‰ç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶<a hidden class="anchor" aria-hidden="true" href="#æƒ…å†µ2æµè§ˆå™¨å¯ä»¥ç»§ç»­è¯»å–åˆšæ‰ç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶">#</a></h4>
<p>è¿™ç§æƒ…å†µï¼Œå¯ä»¥å…ˆè°ƒç”¨ç¬¬4ä¸ªæ¥å£ï¼Œé€šè¿‡æ­¤æ¥å£å¯ä»¥çŸ¥é“é‚£äº›åˆ†ç‰‡è¿˜æœªä¸Šä¼ ï¼Œç„¶åç»§ç»­ä¸Šä¼ è¿™äº›åˆ†ç‰‡å°±å¯ä»¥äº†ã€‚</p>
<h2 id="2-å¤šçº¿ç¨‹ä»»åŠ¡æ‰¹å¤„ç†é€šç”¨å·¥å…·ç±»">2. å¤šçº¿ç¨‹ä»»åŠ¡æ‰¹å¤„ç†é€šç”¨å·¥å…·ç±»<a hidden class="anchor" aria-hidden="true" href="#2-å¤šçº¿ç¨‹ä»»åŠ¡æ‰¹å¤„ç†é€šç”¨å·¥å…·ç±»">#</a></h2>
<p>ç›¸å…³ä»£ç ï¼š<a href="https://github.com/SwimmingLiu/JavaSceneQuiz100/tree/main/lesson002">https://github.com/SwimmingLiu/JavaSceneQuiz100/tree/main/lesson002</a></p>
<blockquote>
<p>ä½¿ç”¨çº¿ç¨‹æ± æ‰¹é‡å‘é€çŸ­ä¿¡ï¼Œå½“çŸ­ä¿¡å‘é€å®Œæ¯•ä¹‹åï¼Œè®°å½•è€—æ—¶æƒ…å†µ</p></blockquote>
<p>åºŸè¯ä¸å¤šè¯´ï¼Œ ç›´æ¥çœ‹ä»£ç 
<strong>ã€ä¸»è¦çŸ¥è¯†ç‚¹ã€‘</strong></p>
<ul>
<li>CountDownLatchï¼šå¦‚æœæƒ³è¦ç­‰å¼‚æ­¥çº¿ç¨‹æ‰§è¡Œä¹‹åï¼Œå†ç»§ç»­å›åˆ°åŸæ–¹æ³•ä¸­ï¼Œå¯ä»¥ä½¿ç”¨CountDownLatch</li>
<li>Executorsï¼šç”¨äºåˆ›å»ºçº¿ç¨‹æ± ï¼Œé‡å†™ <code>executor.execute</code> ä¸­çš„ <code>Runnable</code> æ–¹æ³•ï¼Œå¯å®ç°å¼‚æ­¥æ‰§è¡Œçº¿ç¨‹</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">TaskDisposeUtils</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * ä½¿ç”¨çº¿ç¨‹æ± æ‰¹å¤„ç†æ–‡ä»¶ï¼Œå½“æ‰€æœ‰ä»»åŠ¡å¤„ç†å®Œæ¯•åæ‰ä¼šè¿”å›
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param taskList ä»»åŠ¡åˆ—è¡¨
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param consumer å¤„ç†ä»»åŠ¡çš„æ–¹æ³•
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param executor çº¿ç¨‹æ± 
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param &lt;T&gt;
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @throws InterruptedException
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">dispose</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">taskList</span><span class="p">,</span><span class="w"> </span><span class="n">Consumer</span><span class="o">&lt;?</span><span class="w"> </span><span class="kd">super</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">consumer</span><span class="p">,</span><span class="w"> </span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">taskList</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">taskList</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">consumer</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">CountDownLatch</span><span class="w"> </span><span class="n">latch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CountDownLatch</span><span class="p">(</span><span class="n">taskList</span><span class="p">.</span><span class="na">size</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">taskList</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">executor</span><span class="p">.</span><span class="na">execute</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">consumer</span><span class="p">.</span><span class="na">accept</span><span class="p">(</span><span class="n">item</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">latch</span><span class="p">.</span><span class="na">countDown</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">latch</span><span class="p">.</span><span class="na">await</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="n">startTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">taskList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&#34;çŸ­ä¿¡-1&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;çŸ­ä¿¡-2&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;çŸ­ä¿¡-3&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">ExecutorService</span><span class="w"> </span><span class="n">executor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Executors</span><span class="p">.</span><span class="na">newFixedThreadPool</span><span class="p">(</span><span class="n">10</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">dispose</span><span class="p">(</span><span class="n">taskList</span><span class="p">,</span><span class="w"> </span><span class="n">TaskDisposeUtils</span><span class="p">::</span><span class="n">doTask</span><span class="p">,</span><span class="w"> </span><span class="n">executor</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ä»»åŠ¡å¤„ç†å®Œæ¯•,è€—æ—¶(ms):&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">startTime</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">executor</span><span class="p">.</span><span class="na">shutdown</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">doTask</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">task</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">task</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;å‘é€æˆåŠŸ&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">TimeUnit</span><span class="p">.</span><span class="na">SECONDS</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">interrupt</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="3-æ¥å£æ€§èƒ½å‹åŠ›æµ‹è¯•å·¥å…·">3. æ¥å£æ€§èƒ½å‹åŠ›æµ‹è¯•å·¥å…·<a hidden class="anchor" aria-hidden="true" href="#3-æ¥å£æ€§èƒ½å‹åŠ›æµ‹è¯•å·¥å…·">#</a></h2>
<p>ç›¸å…³ä»£ç ï¼š<a href="https://github.com/SwimmingLiu/JavaSceneQuiz100/tree/main/lesson003">https://github.com/SwimmingLiu/JavaSceneQuiz100/tree/main/lesson003</a></p>
<h3 id="31-å¸¸ç”¨å‹æµ‹å·¥å…·ç±»">3.1 å¸¸ç”¨å‹æµ‹å·¥å…·ç±»<a hidden class="anchor" aria-hidden="true" href="#31-å¸¸ç”¨å‹æµ‹å·¥å…·ç±»">#</a></h3>
<p><a href="https://jmeter.apache.org/">Jemeter</a> ã€<a href="https://blog.csdn.net/light2081/article/details/131175276">LoadRunner</a>ã€ApiFox - è‡ªåŠ¨åŒ–æµ‹è¯•</p>
<p>ã€æ³¨æ„ã€‘LoadRunner åªæœ‰windowå¯ä»¥ç”¨</p>
<h3 id="32-æ‰‹å†™å‹æµ‹å·¥å…·ç±»">3.2 æ‰‹å†™å‹æµ‹å·¥å…·ç±»<a hidden class="anchor" aria-hidden="true" href="#32-æ‰‹å†™å‹æµ‹å·¥å…·ç±»">#</a></h3>
<p>åºŸè¯ä¸å¤šè¯´ï¼Œçœ‹ä»£ç </p>
<p>ã€ä¸»è¦çŸ¥è¯†ç‚¹ã€‘</p>
<ul>
<li>
<p>ä¸ºä»€ä¹ˆ <code>updateFastestTime</code> æ–¹æ³•éœ€è¦ä½¿ç”¨å¾ªç¯è€Œä¸æ˜¯ç›´æ¥ <code>compareAndSet</code> ï¼šå› ä¸ºç›´æ¥ä½¿ç”¨ <code>compareAndSet</code> ä¼šå‡ºç°çº¿ç¨‹ä¸å®‰å…¨çš„æƒ…å†µï¼Œæ¯”å¦‚ä¸‹é¢çš„æƒ…å†µ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// é”™è¯¯çš„åšæ³•ï¼ˆéçº¿ç¨‹å®‰å…¨ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kt">int</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fastestCostTime</span><span class="p">.</span><span class="na">get</span><span class="p">();</span><span class="w">  </span><span class="c1">// çº¿ç¨‹Aè¯»å–åˆ°å€¼100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">current</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">costTime</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">             </span><span class="c1">// çº¿ç¨‹Aåˆ¤æ–­100 &gt; 30ï¼Œå‡†å¤‡æ›´æ–°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// æ­¤æ—¶çº¿ç¨‹Bä¹Ÿè¯»å–åˆ°100ï¼Œä¹Ÿåˆ¤æ–­100 &gt; 50ï¼Œä¹Ÿå‡†å¤‡æ›´æ–°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">fastestCostTime</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="n">costTime</span><span class="p">);</span><span class="w">    </span><span class="c1">// çº¿ç¨‹Aè®¾ç½®ä¸º30</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// çº¿ç¨‹Bè®¾ç½®ä¸º50ï¼Œè¦†ç›–äº†çº¿ç¨‹Açš„ç»“æœ (æœ€å°æ—¶é—´åº”è¯¥æ˜¯30s)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// ä½¿ç”¨whileå¾ªç¯ä¿è¯çº¿ç¨‹å®‰å…¨ ï¼ˆå…¶å®å°±æ˜¯CASï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="kt">int</span><span class="w"> </span><span class="n">fsCostTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fastestCostTime</span><span class="p">.</span><span class="na">get</span><span class="p">();</span><span class="w">  </span><span class="c1">// çº¿ç¨‹Aè¯»å–åˆ°100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">// çº¿ç¨‹Bæ­¤æ—¶å°†å€¼æ”¹ä¸º90</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fastestCostTime</span><span class="p">.</span><span class="na">compareAndSet</span><span class="p">(</span><span class="n">fsCostTime</span><span class="p">,</span><span class="w"> </span><span class="n">costTime</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// çº¿ç¨‹Aå°è¯•å°†100æ”¹ä¸º50</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c1">// å¤±è´¥ï¼å› ä¸ºå½“å‰å€¼å·²ç»æ˜¯90ï¼Œä¸ç­‰äºé¢„æœŸçš„100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">// ç»§ç»­å¾ªç¯ï¼Œé‡æ–°è·å–æœ€æ–°å€¼90ï¼Œå†æ¬¡å°è¯•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>çº¿ç¨‹æ± å‚æ•°ï¼šæ•°ä¾æ¬¡ä¸º <code>coolPoolSize</code> ã€<code>maxPoolSize</code>ã€<code>keepAliveTime</code>ã€<code>TimeUnit</code>ã€<code>waitQueue</code> ç­‰å¾…é˜Ÿåˆ—</p>
</li>
<li>
<p>ä¸ºä»€ä¹ˆçº¿ç¨‹éœ€è¦é¢„çƒ­ï¼šé¢„çƒ­æ˜¯ä¸ºäº†é¿å…çº¿ç¨‹åˆ›å»ºæ—¶å¸¦æ¥çš„é¢å¤–å¼€é”€ï¼Œå¦‚æœä¸é¢„çƒ­ï¼Œå¾ˆå¯èƒ½å‰ <code>100</code> ä¸ªæ ¸å¿ƒçº¿ç¨‹éœ€è¦å¤šæ¶ˆè€— <code>10~50 ms</code> æ¥åˆ›å»ºçº¿ç¨‹</p>
</li>
<li>
<p>AtomicIntegerï¼šé˜²æ­¢å¤šçº¿ç¨‹ä¿®æ”¹åŒä¸€æ•°æ®æ—¶ï¼Œå‡ºç°çº¿ç¨‹ä¸å®‰å…¨çš„æƒ…å†µ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// æ™®é€šIntegerçš„é—®é¢˜</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kt">int</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">counter</span><span class="p">;</span><span class="w">     </span><span class="c1">// 1. è¯»å–</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w">       </span><span class="c1">// 2. ä¿®æ”¹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w">         </span><span class="c1">// 3. å†™å…¥</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// è¿™ä¸‰æ­¥ä¸æ˜¯åŸå­çš„ï¼Œå¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä¸­æ–­</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// AtomicIntegeré‡‡ç”¨CAS + volatile ä¿è¯åŸå­æ€§</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">atomicCounter</span><span class="p">.</span><span class="na">incrementAndGet</span><span class="p">();</span><span class="w">  </span><span class="c1">// åŸå­æ“ä½œ</span><span class="w">
</span></span></span></code></pre></div></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">LoadRunnerUtils</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">LoadRunnerResult</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">requests</span><span class="p">;</span><span class="w">           </span><span class="c1">// è¯·æ±‚æ€»æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">concurrency</span><span class="p">;</span><span class="w">        </span><span class="c1">// å¹¶å‘é‡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">successRequests</span><span class="p">;</span><span class="w">    </span><span class="c1">// æˆåŠŸè¯·æ±‚æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">failRequests</span><span class="p">;</span><span class="w">       </span><span class="c1">// å¤±è´¥è¯·æ±‚æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">timeTakenForTests</span><span class="p">;</span><span class="w">  </span><span class="c1">// è¯·æ±‚æ€»è€—æ—¶(ms)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">requestsPerSecond</span><span class="p">;</span><span class="w"> </span><span class="c1">// æ¯ç§’è¯·æ±‚æ•°ï¼ˆååé‡ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">timePerRequest</span><span class="p">;</span><span class="w">    </span><span class="c1">// æ¯ä¸ªè¯·æ±‚å¹³å‡è€—æ—¶(ms)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">fastestCostTime</span><span class="p">;</span><span class="w">   </span><span class="c1">// æœ€å¿«çš„è¯·æ±‚è€—æ—¶(ms)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">slowestCostTime</span><span class="p">;</span><span class="w">   </span><span class="c1">// æœ€æ…¢çš„è¯·æ±‚è€—æ—¶(ms)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ‰§è¡Œå¹¶å‘å‹åŠ›æµ‹è¯•
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param requests    æ€»è¯·æ±‚æ•°
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param concurrency å¹¶å‘æ•°é‡
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param command     è¢«æµ‹è¯•çš„ä»£ç 
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return å‹æµ‹ç»“æœ
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">LoadRunnerResult</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">requests</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">concurrency</span><span class="p">,</span><span class="w"> </span><span class="n">Runnable</span><span class="w"> </span><span class="n">command</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&#34;å‹æµ‹å¼€å§‹......&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// åˆ›å»ºå›ºå®šå¤§å°çš„çº¿ç¨‹æ± ï¼Œé¢„çƒ­æ‰€æœ‰æ ¸å¿ƒçº¿ç¨‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">ThreadPoolExecutor</span><span class="w"> </span><span class="n">executor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createThreadPool</span><span class="p">(</span><span class="n">concurrency</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ç”¨äºç­‰å¾…æ‰€æœ‰è¯·æ±‚å®Œæˆçš„åŒæ­¥å™¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">CountDownLatch</span><span class="w"> </span><span class="n">latch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CountDownLatch</span><span class="p">(</span><span class="n">requests</span><span class="p">);</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ç»Ÿè®¡æ•°æ®ï¼ˆä½¿ç”¨åŸå­ç±»ä¿è¯çº¿ç¨‹å®‰å…¨ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">AtomicInteger</span><span class="w"> </span><span class="n">successCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AtomicInteger</span><span class="p">(</span><span class="n">0</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">AtomicInteger</span><span class="w"> </span><span class="n">fastestTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AtomicInteger</span><span class="p">(</span><span class="n">Integer</span><span class="p">.</span><span class="na">MAX_VALUE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">AtomicInteger</span><span class="w"> </span><span class="n">slowestTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AtomicInteger</span><span class="p">(</span><span class="n">Integer</span><span class="p">.</span><span class="na">MIN_VALUE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="n">startTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// æäº¤æ‰€æœ‰å‹æµ‹ä»»åŠ¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">requests</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">executor</span><span class="p">.</span><span class="na">execute</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">executeRequest</span><span class="p">(</span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="n">successCount</span><span class="p">,</span><span class="w"> </span><span class="n">fastestTime</span><span class="p">,</span><span class="w"> </span><span class="n">slowestTime</span><span class="p">,</span><span class="w"> </span><span class="n">latch</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ç­‰å¾…æ‰€æœ‰è¯·æ±‚å®Œæˆ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">latch</span><span class="p">.</span><span class="na">await</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">executor</span><span class="p">.</span><span class="na">shutdown</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="n">endTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&#34;å‹æµ‹ç»“æŸï¼Œæ€»è€—æ—¶(ms):{}&#34;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">endTime</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">startTime</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// è¿”å›å‹æµ‹ç»“æœ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * åˆ›å»ºçº¿ç¨‹æ± å¹¶é¢„çƒ­æ ¸å¿ƒçº¿ç¨‹
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">ThreadPoolExecutor</span><span class="w"> </span><span class="nf">createThreadPool</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">concurrency</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// å‚æ•°ä¾æ¬¡ä¸º coolPoolSizeã€maxPoolSizeã€keepAliveTimeã€TimeUnitã€ç­‰å¾…é˜Ÿåˆ—</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">ThreadPoolExecutor</span><span class="w"> </span><span class="n">executor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">concurrency</span><span class="p">,</span><span class="w"> </span><span class="n">concurrency</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">0L</span><span class="p">,</span><span class="w"> </span><span class="n">TimeUnit</span><span class="p">.</span><span class="na">MILLISECONDS</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LinkedBlockingQueue</span><span class="o">&lt;&gt;</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">executor</span><span class="p">.</span><span class="na">prestartAllCoreThreads</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ‰§è¡Œå•ä¸ªè¯·æ±‚å¹¶ç»Ÿè®¡ç»“æœ
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">executeRequest</span><span class="p">(</span><span class="n">Runnable</span><span class="w"> </span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="n">AtomicInteger</span><span class="w"> </span><span class="n">successCount</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                                     </span><span class="n">AtomicInteger</span><span class="w"> </span><span class="n">fastestTime</span><span class="p">,</span><span class="w"> </span><span class="n">AtomicInteger</span><span class="w"> </span><span class="n">slowestTime</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                                     </span><span class="n">CountDownLatch</span><span class="w"> </span><span class="n">latch</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">long</span><span class="w"> </span><span class="n">requestStart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">command</span><span class="p">.</span><span class="na">run</span><span class="p">();</span><span class="w"> </span><span class="c1">// æ‰§è¡Œè¢«æµ‹è¯•çš„æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">costTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">requestStart</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// æ›´æ–°ç»Ÿè®¡æ•°æ®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">updateFastestTime</span><span class="p">(</span><span class="n">fastestTime</span><span class="p">,</span><span class="w"> </span><span class="n">costTime</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">updateSlowestTime</span><span class="p">(</span><span class="n">slowestTime</span><span class="p">,</span><span class="w"> </span><span class="n">costTime</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">successCount</span><span class="p">.</span><span class="na">incrementAndGet</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="s">&#34;è¯·æ±‚æ‰§è¡Œå¤±è´¥: {}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">latch</span><span class="p">.</span><span class="na">countDown</span><span class="p">();</span><span class="w"> </span><span class="c1">// æ ‡è®°å½“å‰è¯·æ±‚å®Œæˆ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * åŸå­æ›´æ–°æœ€å¿«è€—æ—¶
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">updateFastestTime</span><span class="p">(</span><span class="n">AtomicInteger</span><span class="w"> </span><span class="n">fastestTime</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">costTime</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fastestTime</span><span class="p">.</span><span class="na">get</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">current</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">costTime</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">fastestTime</span><span class="p">.</span><span class="na">compareAndSet</span><span class="p">(</span><span class="n">current</span><span class="p">,</span><span class="w"> </span><span class="n">costTime</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div>

  </div>



  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://swimmingliu.cn/tags/java/">Java</a></li>
    </ul>
<nav class="paginav">
  <a class="next" href="https://swimmingliu.cn/posts/job/hensheng-interview-questions/">
    <span class="title">Next Â»</span>
    <br>
    <span>æ’ç”Ÿèšæºé¢ç»è®°å½•</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2023-2025 <a href="https://swimmingliu.cn/">SwimmingLiu&#39;s Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
    <span>
        <a href="https://beian.miit.gov.cn/">æµ™ICPå¤‡2024056260å·</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
